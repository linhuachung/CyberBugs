{"ast":null,"code":"import Axios from 'axios';\nimport { fork, take, takeEvery, delay, takeLatest, call, put } from 'redux-saga/effects';\nimport { GET_TASK_API } from '../constants/TodoListConstants';\nimport { todoListSer } from '../../services/TodoListServices';\nimport { STATUS_CODE } from '../../util/constants/settingSystem';\nimport { DISPLAY_LOADING, HIDE_LOADING } from '../constants/LoadingConst';\nimport { GET_TASKLIST_API, ADD_TASK_API, DELETE_TASK_API, DONE_TASK_API, REJECT_TASK_API } from '../constants/TodoListConstants'; //*----------------------------NHIỆM VỤ GETTASKLIST từ SERVER--------------------------------\n//mỗi hàm generator function là 1 action ( trừ generator function rootSaga)\n\nfunction* getTaskListApiAction(action) {\n  console.log(\"getTaskListApiAction\", action); //*mới vào thì hiển thị loading lên\n  //? put của saga giống vs dispatch action, PUT có thể dispatch action saga lẫn action thường\n\n  yield put({\n    type: DISPLAY_LOADING\n  });\n\n  try {\n    //Hàm call thực thi theo cơ chế blocking. có nghĩa là sau khi promise trong tham số của hàm call trả về response, thì code ở phía dưới mới được thực thi\n    let response = yield call(todoListSer.getTaskApi);\n    yield delay(2000); //! code ở phía trên yield delay sẽ thực hiện trong vòng 2s, sau đó code ở duois mới đc thực hiện ==> nghĩa là sẽ hiển thị loading trong vòng 2s\n\n    console.log(\"RESPONSE\", response);\n\n    if (response.status === STATUS_CODE.SUCCESS) {\n      //*Sau khi lấy giá trị thành công, dùng hàm put(giống vs dispatch bên thunk) để đẩy taskList lấy đc từ serve lêm redux, những component vào useSelector từ redux sẽ cập nhật lại\n      //! yield put có thể dispatch action thường hoặc action saga\n      yield put({\n        type: GET_TASK_API,\n        taskList: response.data\n      });\n    } else {\n      console.log(\"ERROR\");\n    }\n  } catch (error) {\n    console.log(\"ERROR\", error);\n  } //*sau khi lấy đc taskList từ server, các component render lại từ dữu liệu mới của redux xong thì tắt isLoading\n\n\n  yield put({\n    type: HIDE_LOADING\n  });\n} //hàm theo dõi xem action nào đc dispatch lên có type là getTaskListApiAction thì thực hiện hàm xử lí action là getTaskListApiAction\n\n\nexport function* theoDoiActionGetTaskApi() {\n  yield takeLatest(GET_TASKLIST_API, getTaskListApiAction); //?chỉ thực hiện action đc dispatch lần cuối cùng\n} //*----------------------------NHIỆM VỤ ADDTASK lên SERVER--------------------------------\n\nfunction* addTaskApiAction(action) {\n  console.log(\"addTaskApiAction\", action); //gọi api và sau đó hiển thị loading ==> gọi lại hàm getTaskListApiAction để load lại danh sách taskList mới\n\n  let {\n    taskName\n  } = action;\n\n  try {\n    let response = yield call(() => {\n      //call back function thực hiện return về 1 promise\n      return todoListSer.addTaskApi(taskName);\n    });\n    console.log(\"RESPONSE\", response); //?saui khi add task mới lên server thì gọi lại hàm getTaskListApiAction để get về danh sách mới\n\n    if (response.status === STATUS_CODE.SUCCESS) {\n      yield put({\n        type: GET_TASKLIST_API\n      });\n    }\n  } catch (error) {\n    console.log(\"ERROR\", error);\n  }\n}\n\nexport function* theoDoiActionAddTaskApi() {\n  yield takeLatest(ADD_TASK_API, addTaskApiAction);\n} //*----------------------------NHIỆM VỤ DELETETASK --------------------------------\n\nfunction* deleteTaskApiAction(action) {\n  //action này chính là action đc dispatch từ component lên\n  let {\n    taskName\n  } = action;\n\n  try {\n    //*yield call có nhiệm vụ gọi api để deleteTask trên serve(nhận vào 1 function callback trả về 1 promise), sau khi yield call thực thi xong sẽ trả về RESPONSE \n    //dùng bóc tách phần tử để lấy ra taskName = response.taskName\n    const {\n      status\n    } = yield call(() => {\n      return todoListSer.deleteTaskApi(taskName);\n    }); //yield call thực hiện theo cơ chế blocking nên code ở dưới yield call chỉ đc thực hiện khi yield call deleteTask ở server thành công\n    //Nếu thành công thì gọi lại action Saga\n\n    if (status === STATUS_CODE.SUCCESS) {\n      yield put({\n        type: GET_TASKLIST_API\n      });\n    }\n  } catch (err) {\n    console.log(\"ERROR\", err);\n  }\n}\n\nexport function* theoDoiActionDeleteTaskApi() {\n  yield takeLatest(DELETE_TASK_API, deleteTaskApiAction);\n} //*----------------------------NHIỆM VỤ DONETASK --------------------------------\n\nfunction* doneTaskApiAction(action) {\n  let {\n    taskName\n  } = action;\n\n  try {\n    const {\n      status\n    } = yield call(() => {\n      return todoListSer.doneTaskApi(taskName);\n    });\n\n    if (status === STATUS_CODE.SUCCESS) {\n      yield put({\n        type: GET_TASKLIST_API\n      });\n    }\n  } catch (err) {\n    console.log(\"ERROR\", err);\n  }\n}\n\nexport function* theoDoiActionDoneTaskApi() {\n  yield takeLatest(DONE_TASK_API, doneTaskApiAction);\n} //*----------------------------NHIỆM VỤ REJECTTASK --------------------------------\n\nfunction* rejectTaskApiAction(action) {\n  console.log(\"rejectTaskApiAction\");\n  let {\n    taskName\n  } = action;\n\n  try {\n    const {\n      data,\n      status\n    } = yield call(() => todoListSer.rejectTaskApi(taskName));\n\n    if (status === STATUS_CODE.SUCCESS) {\n      yield put({\n        type: GET_TASKLIST_API\n      });\n    }\n  } catch (err) {\n    console.log(\"ERROR\", err);\n  }\n}\n\nexport function* theoDoiActionRejectTaskApi() {\n  yield takeLatest(REJECT_TASK_API, rejectTaskApiAction);\n}","map":{"version":3,"sources":["D:/Chun Folder/Test web html/Cyberbugs1/src/redux/sagas/TodoListSaga.js"],"names":["Axios","fork","take","takeEvery","delay","takeLatest","call","put","GET_TASK_API","todoListSer","STATUS_CODE","DISPLAY_LOADING","HIDE_LOADING","GET_TASKLIST_API","ADD_TASK_API","DELETE_TASK_API","DONE_TASK_API","REJECT_TASK_API","getTaskListApiAction","action","console","log","type","response","getTaskApi","status","SUCCESS","taskList","data","error","theoDoiActionGetTaskApi","addTaskApiAction","taskName","addTaskApi","theoDoiActionAddTaskApi","deleteTaskApiAction","deleteTaskApi","err","theoDoiActionDeleteTaskApi","doneTaskApiAction","doneTaskApi","theoDoiActionDoneTaskApi","rejectTaskApiAction","rejectTaskApi","theoDoiActionRejectTaskApi"],"mappings":"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","sourcesContent":["\r\nimport Axios from 'axios';\r\nimport {fork, take, takeEvery,delay, takeLatest,call, put } from 'redux-saga/effects';\r\nimport {GET_TASK_API} from '../constants/TodoListConstants';\r\nimport {todoListSer} from '../../services/TodoListServices';\r\nimport {STATUS_CODE} from '../../util/constants/settingSystem';\r\nimport {DISPLAY_LOADING, HIDE_LOADING} from '../constants/LoadingConst';\r\nimport {GET_TASKLIST_API, ADD_TASK_API, DELETE_TASK_API, DONE_TASK_API, REJECT_TASK_API} from '../constants/TodoListConstants';\r\n\r\n\r\n\r\n\r\n//*----------------------------NHIỆM VỤ GETTASKLIST từ SERVER--------------------------------\r\n\r\n//mỗi hàm generator function là 1 action ( trừ generator function rootSaga)\r\nfunction * getTaskListApiAction(action) {\r\n\r\n    console.log(\"getTaskListApiAction\",action)\r\n    \r\n    \r\n        //*mới vào thì hiển thị loading lên\r\n        //? put của saga giống vs dispatch action, PUT có thể dispatch action saga lẫn action thường\r\n        yield put({\r\n            type: DISPLAY_LOADING,\r\n        })\r\n\r\n    try {\r\n        //Hàm call thực thi theo cơ chế blocking. có nghĩa là sau khi promise trong tham số của hàm call trả về response, thì code ở phía dưới mới được thực thi\r\n        let response = yield call( todoListSer.getTaskApi);\r\n        \r\n        yield delay(2000); //! code ở phía trên yield delay sẽ thực hiện trong vòng 2s, sau đó code ở duois mới đc thực hiện ==> nghĩa là sẽ hiển thị loading trong vòng 2s\r\n\r\n        console.log(\"RESPONSE\", response);\r\n        if(response.status === STATUS_CODE.SUCCESS) {\r\n\r\n            //*Sau khi lấy giá trị thành công, dùng hàm put(giống vs dispatch bên thunk) để đẩy taskList lấy đc từ serve lêm redux, những component vào useSelector từ redux sẽ cập nhật lại\r\n            //! yield put có thể dispatch action thường hoặc action saga\r\n            yield put({\r\n                type: GET_TASK_API,\r\n                taskList: response.data,\r\n            })\r\n    \r\n            \r\n        } else {\r\n            console.log(\"ERROR\")\r\n        }\r\n        \r\n        \r\n    } catch(error) {\r\n        console.log(\"ERROR\", error);\r\n    }\r\n    \r\n    \r\n    //*sau khi lấy đc taskList từ server, các component render lại từ dữu liệu mới của redux xong thì tắt isLoading\r\n    yield put({\r\n        type: HIDE_LOADING,\r\n    })\r\n}\r\n\r\n\r\n\r\n//hàm theo dõi xem action nào đc dispatch lên có type là getTaskListApiAction thì thực hiện hàm xử lí action là getTaskListApiAction\r\nexport function* theoDoiActionGetTaskApi() {\r\n    yield takeLatest(GET_TASKLIST_API, getTaskListApiAction); //?chỉ thực hiện action đc dispatch lần cuối cùng\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//*----------------------------NHIỆM VỤ ADDTASK lên SERVER--------------------------------\r\n\r\nfunction * addTaskApiAction (action) {\r\n    console.log(\"addTaskApiAction\", action);\r\n    //gọi api và sau đó hiển thị loading ==> gọi lại hàm getTaskListApiAction để load lại danh sách taskList mới\r\n\r\n    let {taskName} = action;\r\n\r\n    try {\r\n\r\n        let response =  yield call(() => {   //call back function thực hiện return về 1 promise\r\n            return todoListSer.addTaskApi(taskName); \r\n        })\r\n\r\n        console.log(\"RESPONSE\", response);\r\n        //?saui khi add task mới lên server thì gọi lại hàm getTaskListApiAction để get về danh sách mới\r\n        if(response.status === STATUS_CODE.SUCCESS) {\r\n            yield put ({\r\n                type: GET_TASKLIST_API,\r\n            })\r\n        }\r\n    } catch(error) {\r\n        console.log(\"ERROR\", error);\r\n    }\r\n\r\n    \r\n\r\n\r\n}\r\n\r\n\r\n\r\nexport function * theoDoiActionAddTaskApi() {\r\n    yield takeLatest(ADD_TASK_API, addTaskApiAction)\r\n} \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//*----------------------------NHIỆM VỤ DELETETASK --------------------------------\r\n\r\nfunction * deleteTaskApiAction(action) {\r\n    //action này chính là action đc dispatch từ component lên\r\n    let {taskName} = action;\r\n\r\n    try {\r\n        \r\n        //*yield call có nhiệm vụ gọi api để deleteTask trên serve(nhận vào 1 function callback trả về 1 promise), sau khi yield call thực thi xong sẽ trả về RESPONSE \r\n        //dùng bóc tách phần tử để lấy ra taskName = response.taskName\r\n        const { status} = yield call (() => {\r\n            return todoListSer.deleteTaskApi(taskName);\r\n        });\r\n\r\n        //yield call thực hiện theo cơ chế blocking nên code ở dưới yield call chỉ đc thực hiện khi yield call deleteTask ở server thành công\r\n        //Nếu thành công thì gọi lại action Saga\r\n        if(status === STATUS_CODE.SUCCESS) {\r\n            yield put({\r\n                type: GET_TASKLIST_API,\r\n            })\r\n        }\r\n\r\n    } catch (err) {\r\n        console.log(\"ERROR\", err);\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n}\r\n\r\n\r\n\r\n\r\nexport function * theoDoiActionDeleteTaskApi() {\r\n    yield takeLatest (DELETE_TASK_API, deleteTaskApiAction)\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//*----------------------------NHIỆM VỤ DONETASK --------------------------------\r\n\r\n\r\n\r\n\r\n\r\n\r\nfunction * doneTaskApiAction(action) {\r\n    let {taskName} = action;\r\n\r\n    try {\r\n        const {status} = yield call(() => {\r\n            return todoListSer.doneTaskApi(taskName)\r\n        });\r\n\r\n        if(status === STATUS_CODE.SUCCESS) {\r\n            yield put({\r\n                type: GET_TASKLIST_API,\r\n            })\r\n        }\r\n\r\n\r\n    }catch(err) {\r\n        console.log(\"ERROR\", err)\r\n    }\r\n\r\n\r\n\r\n\r\n}\r\n\r\n\r\n\r\n\r\nexport function * theoDoiActionDoneTaskApi() {\r\n    yield takeLatest (DONE_TASK_API, doneTaskApiAction)\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//*----------------------------NHIỆM VỤ REJECTTASK --------------------------------\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nfunction * rejectTaskApiAction(action) {\r\n    console.log(\"rejectTaskApiAction\");\r\n\r\n    let {taskName} = action;\r\n\r\n    try {\r\n        const {data, status} = yield call(() => todoListSer.rejectTaskApi(taskName));\r\n\r\n        if(status === STATUS_CODE.SUCCESS) {\r\n            yield put ({\r\n                type: GET_TASKLIST_API,\r\n            })\r\n        }\r\n\r\n\r\n    }catch(err) {\r\n        console.log(\"ERROR\", err);\r\n    }\r\n\r\n\r\n\r\n}\r\n\r\n\r\n\r\n\r\nexport function * theoDoiActionRejectTaskApi() {\r\n    yield takeLatest (REJECT_TASK_API, rejectTaskApiAction)\r\n}\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}